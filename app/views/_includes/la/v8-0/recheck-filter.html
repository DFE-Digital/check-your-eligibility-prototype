

<!-- <div class="govuk-grid-row govuk-!-margin-bottom-2" style="justify-content: flex-end;">
  <div class="govuk-grid-column-full" style="display: flex; align-items: center; justify-content: flex-end;">
    <button id="toggle-filters-btn" type="button" class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0" aria-expanded="true">
      Hide filters
    </button>
  </div>
</div> -->

<button
  id="toggle-filters-btn"
  type="button"
  class="govuk-button govuk-button--secondary govuk-!-margin-bottom-0"
  aria-expanded="true"
  aria-controls="filter-wrapper">
  Hide filters
</button>



<div id="filter-wrapper"
  class="hidden govuk-!-margin-bottom-3 govuk-!-padding-4"
  style="border: 2px solid #b1b4b6; background: #eaeaea;">
  <div class="govuk-form-group" id="filter-container">


      <!-- Search -->
      <div class="govuk-grid-column-one-quarter" style="padding-left: 5px; padding-right: 5px;">
        <div class="govuk-form-group" style="background: white; padding: 15px; min-height: 390px;">
          <fieldset class="govuk-fieldset">
            <div class="govuk-form-group">
            <label class="govuk-label govuk-label--s" for="application">Find an application</label>
          <span id="application-hint" class="govuk-hint govuk-hint--s">For example, 44455453 or child or parent name</span>

            <input class="govuk-input" id="application" name="application" type="text">
          </div>
          </fieldset>
        </div>
      </div>

       <!-- Search bar -->

    <!-- Search bar -->
       <div class="govuk-grid-column-one-quarter" style="padding-left: 5px; padding-right: 5px;">
        <div class="govuk-form-group" style="background: white; padding: 15px; min-height: 390px;">
          <fieldset class="govuk-fieldset">
            <div class="govuk-form-group">
            <label class="govuk-label govuk-label--s" for="school">School</label>
            <span id="school-hint" class="govuk-hint govuk-hint--s">For example, St George's Primary School</span>

            <input class="govuk-input" id="school" name="school" type="text">
          </div>
          </fieldset>
        </div>
      </div>
          <!-- Status -->
  <div class="govuk-grid-column-one-quarter" style="padding-left: 5px; padding-right: 5px;">
        <div class="govuk-form-group" style="background: white; padding: 15px; min-height: 390px;">
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">Recheck status</legend>
            <p class="govuk-hint govuk-hint--s">Select all that apply</p>
            <div class="govuk-checkboxes govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-recheck" name="status" type="checkbox" value="Recheck">
                <label class="govuk-label govuk-checkboxes__label" for="status-recheck">Recheck</label>
              </div>
              <!-- <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-not-checking" name="status" type="checkbox" value="Not checking">
                <label class="govuk-label govuk-checkboxes__label" for="status-not-checking">Checking</label>
              </div> -->
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-inprogress" name="status" type="checkbox" value="In progress">
                <label class="govuk-label govuk-checkboxes__label" for="status-inprogress">In progress</label>
              </div>
                 <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-retry" name="status" type="checkbox" value="Retry">
                <label class="govuk-label govuk-checkboxes__label" for="status-retry">Retry now</label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-not-eligible" name="status" type="checkbox" value="Not eligible">
                <label class="govuk-label govuk-checkboxes__label" for="status-not-eligible">Not eligible</label>
              </div>

              </fieldset>

</div>
</div>

      <!-- Phase of education -->
      <div class="govuk-grid-column-one-quarter" style="padding-left: 5px; padding-right: 5px;">
        <div class="govuk-form-group" style="background: white; padding: 10px; min-height: 400px;">
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">Phase of education</legend>
            <p class="govuk-hint govuk-hint--s">Select all that apply</p>
            <div class="govuk-checkboxes govuk-checkboxes">

              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-nursery" name="phase" type="checkbox" value="Nursery">
                <label class="govuk-label govuk-checkboxes__label" for="phase-nursery">Nursery</label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-primary" name="phase" type="checkbox" value="Primary">
                <label class="govuk-label govuk-checkboxes__label" for="phase-primary">Primary</label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-junior" name="phase" type="checkbox" value="Junior">
                <label class="govuk-label govuk-checkboxes__label" for="phase-junior">Junior</label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-secondary" name="phase" type="checkbox" value="Secondary">
                <label class="govuk-label govuk-checkboxes__label" for="phase-secondary">Secondary</label>
              </div>
               <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-further" name="phase" type="checkbox" value="Further">
                <label class="govuk-label govuk-checkboxes__label" for="phase-further">16+ education</label>
              </div>
               <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="phase-allthrough" name="phase" type="checkbox" value="Allthrough">
                <label class="govuk-label govuk-checkboxes__label" for="phase-allthrough">All-through</label>
              </div>
            </div>
          </fieldset>
        </div>
      </div>


    </div>

    <!-- Filter actions -->
    <div class="govuk-button-group govuk-!-margin-top-3 govuk-!-margin-bottom-0" style="margin-bottom: 0;">
      <button class="govuk-button" id="apply-filters" type="button">Apply filters</button>
      <a href="#" class="govuk-link" id="clear-filters">Clear filters</a>
    </div>

  </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', function () {
  const toggleBtn = document.getElementById('toggle-filters-btn');
  const filterWrapper = document.getElementById('filter-wrapper');

  // If this page doesn't have filters, don't error
  if (!toggleBtn || !filterWrapper) return;

  function updateToggleButton() {
    const isHidden = filterWrapper.classList.contains('hidden');
    toggleBtn.textContent = isHidden ? 'Show filters' : 'Hide filters';
    toggleBtn.setAttribute('aria-expanded', String(!isHidden));
  }

  toggleBtn.addEventListener('click', function () {
    filterWrapper.classList.toggle('hidden');
    updateToggleButton();
  });

  updateToggleButton();
});
</script>


<script>

// Run once on page load (important)
// updateToggleButton();

const appliedFiltersEl = document.getElementById('applied-filters');
const appliedFiltersList = document.getElementById('applied-filters-list');

function getAppliedFilters() {
  const filters = [];

  const application = document.getElementById('application').value.trim();
  if (application) {
    filters.push({ key: 'application', label: application });
  }

  const school = document.getElementById('school').value.trim();
  if (school) {
    filters.push({ key: 'school', label: school });
  }

  document.querySelectorAll('input[name="phase"]:checked').forEach(cb => {
    // Use the label text (nicer than raw value)
    const label = document.querySelector(`label[for="${cb.id}"]`)?.textContent?.trim() || cb.value;
    filters.push({ key: 'phase', id: cb.id, label });
  });

  return filters;
}

function clearFilter(filter) {
  if (filter.key === 'application') document.getElementById('application').value = '';
  if (filter.key === 'school') document.getElementById('school').value = '';
  if (filter.key === 'phase' && filter.id) document.getElementById(filter.id).checked = false;

  // Run whatever you already use to re-filter rows:
  // e.g. applyFilters(); or your existing handler logic
  document.getElementById('apply-filters').click();
}

function renderAppliedFilters() {
  const filters = getAppliedFilters();

  // Hide summary if nothing applied
  appliedFiltersEl.hidden = filters.length === 0;
  appliedFiltersList.innerHTML = '';

  filters.forEach(f => {
    const li = document.createElement('li');
    li.className = 'govuk-!-margin-right-1';

    li.innerHTML = `
      <span class="filter-tag">
        ${f.label}
        <button type="button" class="filter-tag__remove" aria-label="Remove filter: ${f.label}">Ã—</button>
      </span>
    `;

    li.querySelector('button').addEventListener('click', () => clearFilter(f));
    appliedFiltersList.appendChild(li);
  });
}

</script>
